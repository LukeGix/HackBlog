<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="/adminpage.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.3.2/chart.min.js" integrity="sha512-VCHVc5miKoln972iJPvkQrUYYq7XpxXzvqNfiul1H4aZDwGBGC0lq373KNleaB2LpnC2a/iNfE5zoRYmB4TRDQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<title>Welcome admin!</title>
	<%- include('head.ejs')%>
</head>
<body>
	<div class="mask">
		<div class="container-fluid text-white">
			<div class="container-fluid text-center">
				<!-- Begin sidebar -->
				<div class="wrapper">
					<div id="sidebar">
						<div class="sidebar-header text-center">
							<h3>Admin page</h3>
						</div>
						<div id="elements" class="text-center">
								<a href="javascript:void(0)" onclick="closeNav()" id="closebtn">&times;</a>
								<a href="/admin/newblog">Create new article</a>
								<a href="/">Back to home page</a>
								<a href="/logout">Logout</a>
						</div>
					</div>
				</div>	
				<!-- End sidebar -->

				<div align="left" class="container-fluid">
					<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776;</span>
				</div>
				<div class="container-fluid"><h1>Welcome back admin</h1></div>
				<div id="stats" class="container-fluid ">
					<h1>Website analytics (provided by a rudimental analytics engine<sup>TM</sup>)</h1>
					<div class="row">
						<div class="center-card col-sm"><img class="img-card" src="/eye.PNG"><h2 id="visitors">Visitors: </h2></div>
						<div class="center-card col-sm"><img class="img-card" src="/user.PNG"><h2 id="sub">Subscribers: </h2></div>
						<div class="center-card col-sm"><img class="img-card" src="/b.PNG"><h2 id="articles">Articles: </h2></div>
					</div>
				</div>
	
					
			</div>
			<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
		</div>
		<!--L'admin page non ha bisogno di footer--> 
	</div>
	<script type="text/javascript">
		function openNav() {
			document.getElementById('sidebar').style.width = "250px";
		}
		function closeNav(){
			document.getElementById('sidebar').style.width = "0";
		}

		fetch('https://192.168.1.58:1337/api/getcount/sub', {method: 'GET'})
		.then((data) => {
			return data.json();
		})
		.then((d) => {
			document.getElementById('sub').innerHTML += JSON.parse(d).number;
		})
		.catch(err => console.log(err));

		fetch('https://192.168.1.58:1337/api/getcount/visitors', {method: 'GET'})
		.then((data) => {
			return data.json();
		})
		.then((d) => {
			document.getElementById('visitors').innerHTML += JSON.parse(d).number;
		})
		.catch(err => console.log(err));

		fetch('https://192.168.1.58:1337/api/getcount/articles', {method: 'GET'})
		.then((data) => {
			return data.json();
		})
		.then((d) => {
			document.getElementById('articles').innerHTML += JSON.parse(d).number;
		})
		.catch(err => console.log(err));

	</script>

</body>
</html>

